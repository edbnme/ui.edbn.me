{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "icons",
  "type": "registry:lib",
  "title": "Animated Icons",
  "description": "Animated icon components including loading spinners, morphing icons, and close buttons.",
  "dependencies": [
    "motion",
    "@phosphor-icons/react",
    "tw-animate-css"
  ],
  "registryDependencies": [
    "utils"
  ],
  "files": [
    {
      "path": "lib/icons.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport {\n  motion,\n  AnimatePresence,\n  type Variants,\n  type TargetAndTransition,\n  type VariantLabels,\n} from \"motion/react\";\nimport type { Icon } from \"@phosphor-icons/react\";\nimport { cn } from \"@/lib/utils\";\nimport { springPresets } from \"@/lib/motion\";\n\n// =============================================================================\n// ANIMATED ICON WRAPPER\n// Wraps Phosphor icons with Motion for smooth transitions\n// =============================================================================\n\ntype AnimationTarget = boolean | TargetAndTransition | VariantLabels;\n\nexport type AnimatedIconProps = {\n  /** The Phosphor icon component to render */\n  icon: Icon;\n  /** Optional className for styling */\n  className?: string;\n  /** Size of the icon (inherits from parent if not specified) */\n  size?: number | string;\n  /** Stroke width */\n  strokeWidth?: number;\n  /** Animation variants */\n  variants?: Variants;\n  /** Initial animation state */\n  initial?: AnimationTarget;\n  /** Animate to this state */\n  animate?: AnimationTarget;\n  /** Exit animation state */\n  exit?: TargetAndTransition | VariantLabels;\n  /** Layout ID for shared element transitions */\n  layoutId?: string;\n  /** Whether to disable animations */\n  disableAnimation?: boolean;\n} & Omit<React.SVGProps<SVGSVGElement>, \"ref\">;\n\n/**\n * AnimatedIcon - Wraps Lucide icons with Motion for animations\n *\n * @example\n * ```tsx\n * <AnimatedIcon\n *   icon={CheckIcon}\n *   animate={{ scale: 1, opacity: 1 }}\n *   initial={{ scale: 0, opacity: 0 }}\n * />\n * ```\n */\nexport function AnimatedIcon({\n  icon: Icon,\n  className,\n  size,\n  strokeWidth = 2,\n  variants,\n  initial = \"initial\" as VariantLabels,\n  animate = \"animate\" as VariantLabels,\n  exit = \"exit\" as VariantLabels,\n  layoutId,\n  disableAnimation = false,\n  ...props\n}: AnimatedIconProps) {\n  // Filter out motion-specific props that conflict with SVG\n  const {\n    onAnimationStart: _onAnimationStart,\n    onDrag: _onDrag,\n    onDragStart: _onDragStart,\n    onDragEnd: _onDragEnd,\n    ...iconProps\n  } = props as Record<string, unknown>;\n\n  if (disableAnimation) {\n    return (\n      <Icon\n        className={className}\n        size={size}\n        strokeWidth={strokeWidth}\n        {...(iconProps as React.SVGProps<SVGSVGElement>)}\n      />\n    );\n  }\n\n  // Use motion.div wrapper instead of motion.create to avoid ESLint static-components error\n  return (\n    <motion.span\n      className={cn(\"inline-flex shrink-0\", className)}\n      variants={variants}\n      initial={initial}\n      animate={animate}\n      exit={exit}\n      layoutId={layoutId}\n      transition={springPresets.snappy}\n    >\n      <Icon\n        size={size}\n        strokeWidth={strokeWidth}\n        {...(iconProps as React.SVGProps<SVGSVGElement>)}\n      />\n    </motion.span>\n  );\n}\n\n// =============================================================================\n// ICON MORPH - Morphs between two icons\n// =============================================================================\n\nexport type IconMorphProps = {\n  /** First icon (shown when isActive is false) */\n  iconA: Icon;\n  /** Second icon (shown when isActive is true) */\n  iconB: Icon;\n  /** Current state */\n  isActive: boolean;\n  /** Unique ID for layout animations */\n  layoutId?: string;\n  /** Icon size */\n  size?: number | string;\n  /** Stroke width */\n  strokeWidth?: number;\n  /** Additional className */\n  className?: string;\n  /** Whether to disable animations */\n  disableAnimation?: boolean;\n};\n\nconst morphVariants: Variants = {\n  initial: { scale: 0, rotate: -90, opacity: 0 },\n  animate: { scale: 1, rotate: 0, opacity: 1 },\n  exit: { scale: 0, rotate: 90, opacity: 0 },\n};\n\n/**\n * IconMorph - Smoothly transitions between two icons\n *\n * @example\n * ```tsx\n * <IconMorph\n *   iconA={MenuIcon}\n *   iconB={XIcon}\n *   isActive={isMenuOpen}\n * />\n * ```\n */\nexport function IconMorph({\n  iconA: IconA,\n  iconB: IconB,\n  isActive,\n  layoutId,\n  size = 24,\n  strokeWidth = 2,\n  className,\n  disableAnimation = false,\n}: IconMorphProps) {\n  const CurrentIcon = isActive ? IconB : IconA;\n\n  if (disableAnimation) {\n    return (\n      <CurrentIcon\n        className={className}\n        size={size}\n        strokeWidth={strokeWidth}\n      />\n    );\n  }\n\n  return (\n    <div\n      className={cn(\"relative\", className)}\n      style={{ width: size, height: size }}\n    >\n      <AnimatePresence mode=\"wait\" initial={false}>\n        <AnimatedIcon\n          key={isActive ? \"active\" : \"inactive\"}\n          icon={CurrentIcon}\n          size={size}\n          strokeWidth={strokeWidth}\n          variants={morphVariants}\n          layoutId={layoutId}\n          className=\"absolute inset-0\"\n        />\n      </AnimatePresence>\n    </div>\n  );\n}\n\n// =============================================================================\n// LOADING SPINNER\n// Animated spinning loader\n// =============================================================================\n\nexport type LoadingSpinnerProps = {\n  /** Size of the spinner */\n  size?: number;\n  /** Stroke width */\n  strokeWidth?: number;\n  /** Additional className */\n  className?: string;\n  /** Whether to show the spinner */\n  show?: boolean;\n};\n\n/**\n * LoadingSpinner - Animated loading indicator\n */\nexport function LoadingSpinner({\n  size = 16,\n  strokeWidth = 2,\n  className,\n  show = true,\n}: LoadingSpinnerProps) {\n  if (!show) return null;\n\n  return (\n    <motion.svg\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      className={cn(\"animate-spin\", className)}\n      initial={{ opacity: 0, scale: 0.8 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.8 }}\n      transition={springPresets.snappy}\n    >\n      <circle\n        cx=\"12\"\n        cy=\"12\"\n        r=\"10\"\n        stroke=\"currentColor\"\n        strokeWidth={strokeWidth}\n        strokeOpacity={0.25}\n        fill=\"none\"\n      />\n      <path\n        d=\"M12 2C6.477 2 2 6.477 2 12\"\n        stroke=\"currentColor\"\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        fill=\"none\"\n      />\n    </motion.svg>\n  );\n}\n\n// =============================================================================\n// CHECKMARK ICON\n// Animated check mark for success states\n// =============================================================================\n\nexport type AnimatedCheckProps = {\n  /** Size of the checkmark */\n  size?: number;\n  /** Stroke width */\n  strokeWidth?: number;\n  /** Additional className */\n  className?: string;\n  /** Whether to show the checkmark */\n  show?: boolean;\n  /** Delay before animation starts */\n  delay?: number;\n};\n\n/**\n * AnimatedCheck - Draw-on checkmark animation\n */\nexport function AnimatedCheck({\n  size = 24,\n  strokeWidth = 2,\n  className,\n  show = true,\n  delay = 0,\n}: AnimatedCheckProps) {\n  return (\n    <AnimatePresence>\n      {show && (\n        <motion.svg\n          width={size}\n          height={size}\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          className={className}\n          initial={{ opacity: 0, scale: 0.8 }}\n          animate={{ opacity: 1, scale: 1 }}\n          exit={{ opacity: 0, scale: 0.8 }}\n          transition={{ ...springPresets.bouncy, delay }}\n        >\n          <motion.path\n            d=\"M5 13l4 4L19 7\"\n            stroke=\"currentColor\"\n            strokeWidth={strokeWidth}\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            fill=\"none\"\n            initial={{ pathLength: 0 }}\n            animate={{ pathLength: 1 }}\n            transition={{ duration: 0.3, delay: delay + 0.1, ease: \"easeOut\" }}\n          />\n        </motion.svg>\n      )}\n    </AnimatePresence>\n  );\n}\n\n// =============================================================================\n// CLOSE BUTTON\n// Circular close button with animation\n// =============================================================================\n\nexport type CloseButtonProps = {\n  /** Click handler */\n  onClick?: () => void;\n  /** Size of the button */\n  size?: \"sm\" | \"md\" | \"lg\";\n  /** Whether to disable animations */\n  disableAnimation?: boolean;\n  /** Additional className */\n  className?: string;\n  /** ARIA label */\n  \"aria-label\"?: string;\n};\n\nconst sizeMap = {\n  sm: { button: 24, icon: 14 },\n  md: { button: 32, icon: 18 },\n  lg: { button: 40, icon: 22 },\n};\n\n/**\n * CloseButton - Circular close button with smooth animation\n */\nexport function CloseButton({\n  onClick,\n  size = \"md\",\n  disableAnimation = false,\n  className,\n  \"aria-label\": ariaLabel = \"Close\",\n}: CloseButtonProps) {\n  const dimensions = sizeMap[size];\n\n  const ButtonComponent = disableAnimation ? \"button\" : motion.button;\n  const motionProps = disableAnimation\n    ? {}\n    : {\n        whileHover: { scale: 1.1, backgroundColor: \"var(--muted)\" },\n        whileTap: { scale: 0.95 },\n        transition: springPresets.snappy,\n      };\n\n  return (\n    <ButtonComponent\n      type=\"button\"\n      onClick={onClick}\n      className={cn(\n        \"inline-flex items-center justify-center rounded-full\",\n        \"bg-muted/50 text-muted-foreground hover:bg-muted hover:text-foreground\",\n        \"transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\",\n        className,\n      )}\n      style={{\n        width: dimensions.button,\n        height: dimensions.button,\n      }}\n      aria-label={ariaLabel}\n      {...motionProps}\n    >\n      <svg\n        width={dimensions.icon}\n        height={dimensions.icon}\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth={2}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <path d=\"M18 6L6 18\" />\n        <path d=\"M6 6l12 12\" />\n      </svg>\n    </ButtonComponent>\n  );\n}\n\n// =============================================================================\n// CHEVRON ICON\n// Rotatable chevron for expandable sections\n// =============================================================================\n\nexport type AnimatedChevronProps = {\n  /** Direction/rotation state */\n  direction: \"up\" | \"down\" | \"left\" | \"right\";\n  /** Size of the chevron */\n  size?: number;\n  /** Additional className */\n  className?: string;\n  /** Whether to disable animations */\n  disableAnimation?: boolean;\n};\n\nconst rotationMap = {\n  up: -90,\n  down: 90,\n  left: 180,\n  right: 0,\n};\n\n/**\n * AnimatedChevron - Smoothly rotates between directions\n */\nexport function AnimatedChevron({\n  direction,\n  size = 16,\n  className,\n  disableAnimation = false,\n}: AnimatedChevronProps) {\n  const rotation = rotationMap[direction];\n\n  const SvgComponent = disableAnimation ? \"svg\" : motion.svg;\n  const motionProps = disableAnimation\n    ? { style: { transform: `rotate(${rotation}deg)` } }\n    : {\n        animate: { rotate: rotation },\n        transition: springPresets.snappy,\n      };\n\n  return (\n    <SvgComponent\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth={2}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      className={className}\n      {...motionProps}\n    >\n      <path d=\"M9 18l6-6-6-6\" />\n    </SvgComponent>\n  );\n}\n\n// =============================================================================\n// DRAG HANDLE\n// Pill indicator for draggable sheets\n// =============================================================================\n\nexport type DragHandleProps = {\n  /** Additional className */\n  className?: string;\n};\n\n/**\n * DragHandle - Drag indicator pill for sheets\n */\nexport function DragHandle({ className }: DragHandleProps) {\n  return (\n    <div\n      className={cn(\n        \"mx-auto w-10 h-1.5 rounded-full bg-muted-foreground/30\",\n        \"shrink-0\",\n        className,\n      )}\n      aria-hidden=\"true\"\n    />\n  );\n}\n",
      "type": "registry:lib"
    },
    {
      "path": "components/motion-provider.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { createContext, useContext, useMemo } from \"react\";\nimport { MotionConfig, type Transition } from \"motion/react\";\nimport { useReducedMotion } from \"@/hooks/use-reduced-motion\";\nimport { useLowPowerDevice } from \"@/hooks/use-low-power-device\";\nimport { transitions } from \"@/lib/motion\";\n\n// =============================================================================\n// TYPES\n// =============================================================================\n\nexport type ReducedMotionSetting = \"user\" | \"always\" | \"never\";\n\nexport type MotionContextValue = {\n  /** Current reduced motion setting */\n  reducedMotion: ReducedMotionSetting;\n  /** Whether animations are effectively disabled */\n  isAnimationDisabled: boolean;\n  /** Whether low-power mode auto-disable is enabled */\n  lowPowerAutoDisable: boolean;\n  /** Low power device state */\n  lowPowerState: {\n    isLowPower: boolean;\n    batteryLevel: number | null;\n    isCharging: boolean | null;\n  };\n  /** Default transition based on current settings */\n  defaultTransition: Transition;\n};\n\nexport type MotionProviderProps = {\n  children: React.ReactNode;\n  /** How to handle reduced motion: 'user' (system preference), 'always' (force reduced), 'never' (force animations) */\n  reducedMotion?: ReducedMotionSetting;\n  /** Automatically disable animations on low-power devices */\n  lowPowerAutoDisable?: boolean;\n  /** Default transition for all Motion components */\n  defaultTransition?: Transition;\n  /** Additional className for the provider wrapper */\n  className?: string;\n};\n\n// =============================================================================\n// CONTEXT\n// =============================================================================\n\nconst MotionContext = createContext<MotionContextValue | null>(null);\n\n/**\n * Hook to access motion configuration\n *\n * @returns Motion context value with animation settings\n * @throws Error if used outside of MotionProvider\n *\n * @example\n * ```tsx\n * function AnimatedButton() {\n *   const { isAnimationDisabled } = useMotionConfig();\n *\n *   return (\n *     <motion.button\n *       whileTap={isAnimationDisabled ? undefined : { scale: 0.95 }}\n *     />\n *   );\n * }\n * ```\n */\nexport function useMotionConfig(): MotionContextValue {\n  const context = useContext(MotionContext);\n\n  if (!context) {\n    throw new Error(\"useMotionConfig must be used within a MotionProvider\");\n  }\n\n  return context;\n}\n\n/**\n * Hook to check if animations should be disabled for a component\n *\n * @param disableAnimation - Optional local override to disable animation\n * @returns Whether animations should be disabled\n *\n * @example\n * ```tsx\n * function Button({ disableAnimation }) {\n *   const shouldDisable = useShouldDisableAnimation(disableAnimation);\n *\n *   if (shouldDisable) {\n *     return <button>Click me</button>;\n *   }\n *\n *   return <motion.button whileTap={{ scale: 0.95 }}>Click me</motion.button>;\n * }\n * ```\n */\nexport function useShouldDisableAnimation(disableAnimation?: boolean): boolean {\n  const context = useContext(MotionContext);\n  const prefersReducedMotion = useReducedMotion();\n\n  // Local override takes precedence\n  if (disableAnimation !== undefined) {\n    return disableAnimation;\n  }\n\n  // If no provider, check system preference directly\n  if (!context) {\n    return prefersReducedMotion;\n  }\n\n  return context.isAnimationDisabled;\n}\n\n/**\n * Hook to get the appropriate transition based on animation settings\n *\n * @param transition - Desired transition when animations are enabled\n * @param disableAnimation - Optional local override\n * @returns The transition to use (reduced if animations disabled)\n */\nexport function useAnimationTransition(\n  transition: Transition = transitions.default,\n  disableAnimation?: boolean,\n): Transition {\n  const shouldDisable = useShouldDisableAnimation(disableAnimation);\n\n  if (shouldDisable) {\n    return transitions.reduced;\n  }\n\n  return transition;\n}\n\n// =============================================================================\n// PROVIDER COMPONENT\n// =============================================================================\n\n/**\n * MotionProvider - Global animation configuration provider\n *\n * Wraps Motion's MotionConfig with additional context for:\n * - Reduced motion preferences (system or manual)\n * - Low-power device detection\n * - Global transition defaults\n *\n * @example\n * ```tsx\n * // In your app layout\n * <MotionProvider\n *   reducedMotion=\"user\"\n *   lowPowerAutoDisable\n * >\n *   <App />\n * </MotionProvider>\n * ```\n */\nexport function MotionProvider({\n  children,\n  reducedMotion = \"user\",\n  lowPowerAutoDisable = true,\n  defaultTransition = transitions.default,\n}: MotionProviderProps) {\n  // System preference for reduced motion\n  const prefersReducedMotion = useReducedMotion();\n\n  // Low-power device detection\n  const lowPowerState = useLowPowerDevice();\n\n  // Determine if animations should be disabled\n  const isAnimationDisabled = useMemo(() => {\n    // 'always' forces reduced motion\n    if (reducedMotion === \"always\") {\n      return true;\n    }\n\n    // 'never' forces animations (ignores preferences)\n    if (reducedMotion === \"never\") {\n      return false;\n    }\n\n    // 'user' respects system preference\n    if (prefersReducedMotion) {\n      return true;\n    }\n\n    // Check low-power mode if auto-disable is enabled\n    if (lowPowerAutoDisable && lowPowerState.shouldReduceAnimations) {\n      return true;\n    }\n\n    return false;\n  }, [\n    reducedMotion,\n    prefersReducedMotion,\n    lowPowerAutoDisable,\n    lowPowerState.shouldReduceAnimations,\n  ]);\n\n  // Get effective transition\n  const effectiveTransition = useMemo(() => {\n    if (isAnimationDisabled) {\n      return transitions.reduced;\n    }\n    return defaultTransition;\n  }, [isAnimationDisabled, defaultTransition]);\n\n  // Context value\n  const contextValue = useMemo<MotionContextValue>(\n    () => ({\n      reducedMotion,\n      isAnimationDisabled,\n      lowPowerAutoDisable,\n      lowPowerState: {\n        isLowPower: lowPowerState.isLowPower,\n        batteryLevel: lowPowerState.batteryLevel,\n        isCharging: lowPowerState.isCharging,\n      },\n      defaultTransition: effectiveTransition,\n    }),\n    [\n      reducedMotion,\n      isAnimationDisabled,\n      lowPowerAutoDisable,\n      lowPowerState.isLowPower,\n      lowPowerState.batteryLevel,\n      lowPowerState.isCharging,\n      effectiveTransition,\n    ],\n  );\n\n  return (\n    <MotionContext.Provider value={contextValue}>\n      <MotionConfig\n        transition={effectiveTransition}\n        reducedMotion={isAnimationDisabled ? \"always\" : \"user\"}\n      >\n        {children}\n      </MotionConfig>\n    </MotionContext.Provider>\n  );\n}\n\n// =============================================================================\n// EXPORTS\n// =============================================================================\n\nexport { MotionContext };\n",
      "type": "registry:component"
    },
    {
      "path": "hooks/use-reduced-motion.ts",
      "content": "\"use client\";\n\nimport { useSyncExternalStore, useCallback } from \"react\";\n\n/**\n * Hook to detect user's reduced motion preference\n *\n * Uses the `prefers-reduced-motion` media query to detect if the user\n * has requested reduced motion in their system settings.\n *\n * @param override - Optional boolean to override the system preference\n * @returns Whether reduced motion is preferred\n *\n * @example\n * ```tsx\n * function MyComponent() {\n *   const prefersReducedMotion = useReducedMotion();\n *\n *   return (\n *     <motion.div\n *       animate={{ x: prefersReducedMotion ? 0 : 100 }}\n *     />\n *   );\n * }\n * ```\n */\nexport function useReducedMotion(override?: boolean): boolean {\n  const subscribe = useCallback((callback: () => void) => {\n    if (typeof window === \"undefined\") return () => {};\n\n    const mediaQuery = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\n\n    mediaQuery.addEventListener(\"change\", callback);\n    return () => mediaQuery.removeEventListener(\"change\", callback);\n  }, []);\n\n  const getSnapshot = useCallback(() => {\n    if (typeof window === \"undefined\") return false;\n    return window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches;\n  }, []);\n\n  // Server snapshot should always return false for SSR\n  const getServerSnapshot = useCallback(() => false, []);\n\n  const prefersReducedMotion = useSyncExternalStore(\n    subscribe,\n    getSnapshot,\n    getServerSnapshot,\n  );\n\n  // Override takes precedence if provided\n  if (override !== undefined) {\n    return override;\n  }\n\n  return prefersReducedMotion;\n}\n\nexport default useReducedMotion;\n",
      "type": "registry:hook"
    },
    {
      "path": "hooks/use-low-power-device.ts",
      "content": "\"use client\";\n\nimport { useSyncExternalStore, useCallback } from \"react\";\n\n/**\n * Hook to detect if the device is in a low-power state\n *\n * Checks Battery API and hardware concurrency to determine if\n * animations should be reduced for performance reasons.\n *\n * @returns Object with power state information\n *\n * @example\n * ```tsx\n * function AnimatedComponent() {\n *   const { isLowPower, shouldReduceAnimations } = useLowPowerDevice();\n *\n *   return (\n *     <motion.div\n *       animate={{ scale: shouldReduceAnimations ? 1 : 1.1 }}\n *     />\n *   );\n * }\n * ```\n */\n\ntype BatteryManager = {\n  charging: boolean;\n  level: number;\n  addEventListener: (type: string, listener: () => void) => void;\n  removeEventListener: (type: string, listener: () => void) => void;\n};\n\ntype NavigatorWithBattery = Navigator & {\n  getBattery?: () => Promise<BatteryManager>;\n};\n\nexport type LowPowerState = {\n  /** Whether the device is considered low-power */\n  isLowPower: boolean;\n  /** Whether animations should be reduced */\n  shouldReduceAnimations: boolean;\n  /** Battery level (0-1) if available */\n  batteryLevel: number | null;\n  /** Whether the device is charging */\n  isCharging: boolean | null;\n  /** Number of logical CPU cores */\n  hardwareConcurrency: number;\n};\n\n// Battery state cache\nlet batteryManager: BatteryManager | null = null;\nlet batteryPromise: Promise<BatteryManager | null> | null = null;\n\n// Get battery manager (cached)\nasync function getBatteryManager(): Promise<BatteryManager | null> {\n  if (batteryManager) return batteryManager;\n  if (batteryPromise) return batteryPromise;\n\n  if (typeof navigator === \"undefined\") return null;\n\n  const nav = navigator as NavigatorWithBattery;\n  if (!nav.getBattery) return null;\n\n  batteryPromise = nav.getBattery().catch(() => null);\n  batteryManager = await batteryPromise;\n  return batteryManager;\n}\n\n// Initialize battery manager on module load\nif (typeof window !== \"undefined\") {\n  getBatteryManager();\n}\n\n// Server snapshot - defined once at module level to avoid re-creation\nconst serverSnapshot: LowPowerState = {\n  isLowPower: false,\n  shouldReduceAnimations: false,\n  batteryLevel: null,\n  isCharging: null,\n  hardwareConcurrency: 4,\n};\n\n// Cache the current snapshot to avoid unnecessary re-renders\nlet cachedSnapshot: LowPowerState = serverSnapshot;\n\n// Function to get current snapshot (called outside of React)\nfunction getCurrentSnapshot(): LowPowerState {\n  if (typeof window === \"undefined\") {\n    return serverSnapshot;\n  }\n\n  const hardwareConcurrency = navigator.hardwareConcurrency || 4;\n  const isLowEndDevice = hardwareConcurrency <= 4;\n\n  // Check battery if available\n  let batteryLevel: number | null = null;\n  let isCharging: boolean | null = null;\n  let isLowBattery = false;\n\n  if (batteryManager) {\n    batteryLevel = batteryManager.level;\n    isCharging = batteryManager.charging;\n    // Consider low battery if below 20% and not charging\n    isLowBattery = batteryLevel < 0.2 && !isCharging;\n  }\n\n  const isLowPower = isLowEndDevice || isLowBattery;\n  const shouldReduceAnimations = isLowPower;\n\n  // Only create new object if values actually changed\n  const newSnapshot = {\n    isLowPower,\n    shouldReduceAnimations,\n    batteryLevel,\n    isCharging,\n    hardwareConcurrency,\n  };\n\n  // Compare with cached snapshot\n  if (\n    cachedSnapshot.isLowPower === newSnapshot.isLowPower &&\n    cachedSnapshot.shouldReduceAnimations ===\n      newSnapshot.shouldReduceAnimations &&\n    cachedSnapshot.batteryLevel === newSnapshot.batteryLevel &&\n    cachedSnapshot.isCharging === newSnapshot.isCharging &&\n    cachedSnapshot.hardwareConcurrency === newSnapshot.hardwareConcurrency\n  ) {\n    return cachedSnapshot;\n  }\n\n  cachedSnapshot = newSnapshot;\n  return cachedSnapshot;\n}\n\nexport function useLowPowerDevice(): LowPowerState {\n  const getSnapshot = () => getCurrentSnapshot();\n\n  const getServerSnapshot = () => serverSnapshot;\n\n  const subscribe = useCallback((callback: () => void) => {\n    if (typeof window === \"undefined\") return () => {};\n\n    // Subscribe to battery events if available\n    getBatteryManager().then((battery) => {\n      if (battery) {\n        battery.addEventListener(\"chargingchange\", callback);\n        battery.addEventListener(\"levelchange\", callback);\n      }\n    });\n\n    // Clean up\n    return () => {\n      if (batteryManager) {\n        batteryManager.removeEventListener(\"chargingchange\", callback);\n        batteryManager.removeEventListener(\"levelchange\", callback);\n      }\n    };\n  }, []);\n\n  return useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot);\n}\n\nexport default useLowPowerDevice;\n",
      "type": "registry:hook"
    },
    {
      "path": "lib/motion.ts",
      "content": "import type { Transition, Variants } from \"motion/react\";\n\n// =============================================================================\n// SPRING PRESETS\n// Spring physics configurations for animations\n// =============================================================================\n\n/**\n * Spring presets for consistent animations\n */\nexport const springPresets = {\n  /**\n   * Snappy - Quick, responsive interactions (buttons, toggles)\n   * High stiffness, high damping = fast and controlled\n   */\n  snappy: {\n    type: \"spring\" as const,\n    stiffness: 400,\n    damping: 30,\n    mass: 1,\n  },\n\n  /**\n   * Bouncy - Playful, attention-grabbing (notifications, toasts)\n   * Medium stiffness, lower damping = visible bounce\n   */\n  bouncy: {\n    type: \"spring\" as const,\n    stiffness: 300,\n    damping: 20,\n    mass: 1,\n  },\n\n  /**\n   * Smooth - Slow transitions (modals, sheets)\n   * Lower stiffness, higher damping = graceful movement\n   */\n  smooth: {\n    type: \"spring\" as const,\n    stiffness: 200,\n    damping: 25,\n    mass: 1,\n  },\n\n  /**\n   * Gentle - Subtle, background animations (fade, scale)\n   * Very low stiffness, high damping = barely perceptible\n   */\n  gentle: {\n    type: \"spring\" as const,\n    stiffness: 150,\n    damping: 30,\n    mass: 1,\n  },\n\n  /**\n   * Interactive - Drag and gesture responses\n   * Balanced for real-time responsiveness\n   */\n  interactive: {\n    type: \"spring\" as const,\n    stiffness: 500,\n    damping: 35,\n    mass: 0.8,\n  },\n} as const;\n\n// =============================================================================\n// TRANSITION PRESETS\n// Pre-configured transitions for common use cases\n// =============================================================================\n\nexport const transitions = {\n  /** Standard transition using snappy spring */\n  default: springPresets.snappy as Transition,\n\n  /** For modal/dialog opening animations */\n  modal: springPresets.smooth as Transition,\n\n  /** For dropdown/popover appearance */\n  popover: {\n    ...springPresets.snappy,\n    duration: 0.2,\n  } as Transition,\n\n  /** For morphing popover with layoutId */\n  morphingPopover: {\n    type: \"spring\" as const,\n    bounce: 0.05,\n    duration: 0.3,\n  } as Transition,\n\n  /** For sheet slide-in animations */\n  sheet: {\n    ...springPresets.smooth,\n    damping: 28,\n  } as Transition,\n\n  /** For button press feedback */\n  button: {\n    ...springPresets.interactive,\n    duration: 0.1,\n  } as Transition,\n\n  /** For icon state changes */\n  icon: {\n    ...springPresets.bouncy,\n    duration: 0.3,\n  } as Transition,\n\n  /** For staggered list items */\n  stagger: {\n    staggerChildren: 0.03,\n    delayChildren: 0.05,\n  } as Transition,\n\n  /** Fast fade for overlays */\n  fade: {\n    type: \"tween\" as const,\n    duration: 0.15,\n    ease: \"easeOut\",\n  } as Transition,\n\n  /** Reduced motion fallback - instant transitions */\n  reduced: {\n    type: \"tween\" as const,\n    duration: 0,\n  } as Transition,\n} as const;\n\n// =============================================================================\n// VARIANT FACTORIES\n// Create animation variants for common patterns\n// =============================================================================\n\n/**\n * Creates scale variants for press/tap interactions\n */\nexport function createPressVariants(scale: number = 0.97): Variants {\n  return {\n    idle: { scale: 1 },\n    pressed: { scale },\n  };\n}\n\n/**\n * Creates hover scale variants\n */\nexport function createHoverVariants(scale: number = 1.02): Variants {\n  return {\n    idle: { scale: 1 },\n    hovered: { scale },\n  };\n}\n\n/**\n * Creates fade + scale variants for modal-like components\n */\nexport function createModalVariants(options?: {\n  initialScale?: number;\n  exitScale?: number;\n}): Variants {\n  const { initialScale = 0.95, exitScale = 0.95 } = options ?? {};\n\n  return {\n    initial: {\n      opacity: 0,\n      scale: initialScale,\n    },\n    animate: {\n      opacity: 1,\n      scale: 1,\n    },\n    exit: {\n      opacity: 0,\n      scale: exitScale,\n    },\n  };\n}\n\n/**\n * Creates slide variants for sheets/drawers\n */\nexport function createSlideVariants(\n  side: \"top\" | \"right\" | \"bottom\" | \"left\",\n): Variants {\n  const transforms: Record<\n    string,\n    { x?: string | number; y?: string | number }\n  > = {\n    top: { y: \"-100%\" },\n    right: { x: \"100%\" },\n    bottom: { y: \"100%\" },\n    left: { x: \"-100%\" },\n  };\n\n  return {\n    initial: { ...transforms[side], opacity: 0 },\n    animate: { x: 0, y: 0, opacity: 1 },\n    exit: { ...transforms[side], opacity: 0 },\n  };\n}\n\n/**\n * Creates staggered children variants for lists\n */\nexport function createStaggerVariants(options?: {\n  staggerChildren?: number;\n  delayChildren?: number;\n}): Variants {\n  const { staggerChildren = 0.03, delayChildren = 0.05 } = options ?? {};\n\n  return {\n    initial: { opacity: 0 },\n    animate: {\n      opacity: 1,\n      transition: {\n        staggerChildren,\n        delayChildren,\n      },\n    },\n    exit: {\n      opacity: 0,\n      transition: {\n        staggerChildren: staggerChildren / 2,\n        staggerDirection: -1,\n      },\n    },\n  };\n}\n\n/**\n * Creates item variants for staggered lists\n */\nexport function createStaggerItemVariants(options?: {\n  y?: number;\n  scale?: number;\n}): Variants {\n  const { y = 10, scale = 0.95 } = options ?? {};\n\n  return {\n    initial: { opacity: 0, y, scale },\n    animate: { opacity: 1, y: 0, scale: 1 },\n    exit: { opacity: 0, y: y / 2, scale },\n  };\n}\n\n/**\n * Creates morphing popover variants with blur\n */\nexport function createMorphingPopoverVariants(options?: {\n  initialScale?: number;\n  exitScale?: number;\n  initialBlur?: number;\n  exitBlur?: number;\n}): Variants {\n  const {\n    initialScale = 0.9,\n    exitScale = 0.95,\n    initialBlur = 10,\n    exitBlur = 10,\n  } = options ?? {};\n\n  return {\n    initial: {\n      opacity: 0,\n      scale: initialScale,\n      filter: `blur(${initialBlur}px)`,\n    },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      filter: \"blur(0px)\",\n      transition: {\n        type: \"spring\",\n        bounce: 0,\n        duration: 0.3,\n        staggerChildren: 0.05,\n      },\n    },\n    exit: {\n      opacity: 0,\n      scale: exitScale,\n      filter: `blur(${exitBlur}px)`,\n      transition: {\n        duration: 0.2,\n      },\n    },\n  };\n}\n\n/**\n * Creates backdrop/overlay variants\n */\nexport function createBackdropVariants(): Variants {\n  return {\n    initial: { opacity: 0 },\n    animate: { opacity: 1 },\n    exit: { opacity: 0 },\n  };\n}\n\n/**\n * Creates origin-aware scale variants for popovers/dropdowns\n * Scales from the origin point (where it appears from)\n */\nexport function createPopoverVariants(options?: {\n  initialScale?: number;\n  originX?: number;\n  originY?: number;\n}): Variants {\n  const { initialScale = 0.95, originX = 0.5, originY = 0 } = options ?? {};\n\n  return {\n    initial: {\n      opacity: 0,\n      scale: initialScale,\n      originX,\n      originY,\n    },\n    animate: {\n      opacity: 1,\n      scale: 1,\n    },\n    exit: {\n      opacity: 0,\n      scale: initialScale,\n    },\n  };\n}\n\n// =============================================================================\n// GESTURE PRESETS\n// Common gesture configurations\n// =============================================================================\n\nexport const gestures = {\n  /** Standard button tap feedback */\n  button: {\n    whileTap: { scale: 0.97 },\n    whileHover: { scale: 1.02 },\n  },\n\n  /** Subtle press for secondary actions */\n  subtle: {\n    whileTap: { scale: 0.99 },\n  },\n\n  /** Icon button feedback */\n  iconButton: {\n    whileTap: { scale: 0.9 },\n    whileHover: { scale: 1.1 },\n  },\n\n  /** Card hover effect */\n  card: {\n    whileHover: { scale: 1.02, y: -4 },\n    transition: springPresets.smooth,\n  },\n\n  /** List item hover */\n  listItem: {\n    whileHover: { x: 4 },\n    transition: springPresets.snappy,\n  },\n} as const;\n\n// =============================================================================\n// DRAG CONFIGURATION\n// For swipeable/draggable components\n// =============================================================================\n\nexport const dragConfig = {\n  /** Sheet swipe-to-dismiss threshold */\n  sheet: {\n    dismissThreshold: 100,\n    velocityThreshold: 500,\n  },\n\n  /** Drag constraints for bounded elements */\n  bounded: {\n    elastic: 0.1,\n    power: 0.8,\n  },\n} as const;\n\n// =============================================================================\n// EASING FUNCTIONS\n// Cubic-bezier curves for animations\n// =============================================================================\n\nexport const easings = {\n  /** Standard curve */\n  standard: [0.25, 0.1, 0.25, 1],\n  /** Ease-in */\n  easeIn: [0.42, 0, 1, 1],\n  /** Ease-out */\n  easeOut: [0, 0, 0.58, 1],\n  /** Emphasized */\n  emphasis: [0.33, 1, 0.68, 1],\n  /** Linear */\n  linear: [0, 0, 1, 1],\n} as const;\n\n// =============================================================================\n// DURATION PRESETS\n// Consistent timing values\n// =============================================================================\n\nexport const durations = {\n  instant: 0,\n  fast: 0.1,\n  normal: 0.2,\n  slow: 0.3,\n  slower: 0.5,\n  slowest: 0.8,\n} as const;\n\n// =============================================================================\n// UTILITY FUNCTIONS\n// =============================================================================\n\n/**\n * Combines multiple variant objects\n */\nexport function mergeVariants(...variants: Variants[]): Variants {\n  return variants.reduce((acc, variant) => ({ ...acc, ...variant }), {});\n}\n\n/**\n * Creates a transition that respects reduced motion\n */\nexport function getTransition(\n  transition: Transition,\n  prefersReducedMotion: boolean,\n): Transition {\n  if (prefersReducedMotion) {\n    return transitions.reduced;\n  }\n  return transition;\n}\n\n/**\n * Generates a layoutId for shared element transitions\n */\nexport function createLayoutId(prefix: string, id: string | number): string {\n  return `${prefix}-${id}`;\n}\n",
      "type": "registry:lib"
    }
  ]
}